---
title: Recipes & Unlocks
date: "2025-05-25T13:15:07+01:00"
status: publish
categories:
  - triangle
tags:
  - crafting
  - research
aliases:
  - /s/t/recipes
---

The rudimentary logic that I had for refining, which I mentioned in [devlog
#3]({% post_url triangle/2025-05-13-materials %}#refining) was adequate for smelting,
but it was not going to enough for tracking item crafting. For this, I need more
sophisticated recipe management.

After a lot of working stuff out, and metaphorically stumbling about, I
identifed a few key bits of functionality.

## Unlocks

We need to be able to unlock recipes based on specific triggers

- _Pick up iron_ → unlock **Smelter**
- _Smelt iron_ → unlock **constructor**
- _Build item_ → unlock **Disassembler**
- _First combat hit_ → unlock **Armor**
- _Craft armor_ → unlock **Laser Weapons**
- _Power shortage_ → unlock **power systems**
- _Discover new area_ → unlock **scanner**

<!-- more -->

These are only rough ideas on how it might pan out. I want unlocks to feel like
the ship being intuitive, and trying to give the player what they want. It won't
always get it right - and that's ok. I do, however, want it to feel like the
ship is trying.

In terms of unlocking tiers, I expect that to happen through research (which is
a dev log for much later). Research would work by dumping items into Labs. Each
item has a percentage chance of unlocking the next tier. When unlocked, it will
also provide one item of that tier.

For the different types of defensive structures (Shields, Armour, EMP Shielding
etc), I imagine being unlocked when first attacked by type of weapon for which
it is a defence.

As for the different weapons, perhaps they could be unlocked when the
corresponding armour is installed.

There are other item types too, including:

- Attractors: to make picking items up easier
- Computers: To analyse items to speculate on changes when switching items
- Scanners: View more space - zooms out.
- Propulsion: move faster

### Defining unlock triggers

From a technical perspective, I need to be able to define a relatively generic
trigger. When events happen (e.g. an item is crafted), we can then check if that
trigger matches a recipe to be unlocked.

```zig
const Trigger = union(enum) {
    pickup: Material.Element, // Element of material picked up
    craft: usize, // id of recipe that was crafted
};
```

We'll start off with two types of triggers.

- **pickup**: When some material (e.g. iron) is picked up for the first time.
- **craft**: When an item (e.g. constructor) is crafted for the first time.
